window.DRTVideoSidebar_debug=window.DRTOptimize_config["debug"];window.DRTVideoSidebar_enable=true;window.DRTVideoSidebar_maxvideos=2;window.DRTVideoSidebar_maxvideos_mobile=2;window.DRTVideoSidebar_enableDesktop=true;window.DRTVideoSidebar_enableMobile=true;var DRTVideoSidebar=DRTVideoSidebar||{};DRTVideoSidebar=(function(){var initiated=false;var player=false;var imaManager=false;function load(){(function(c){var l={},b,m,e=document,j=window,i=e.documentElement,k=c.expando,a;c.event.special.inview={add:function(d){l[d.guid+"-"+this[k]]={data:d,$element:c(this)};if(!a&&!c.isEmptyObject(l)){a=setInterval(g,250);}},remove:function(d){try{delete l[d.guid+"-"+this[k]];}catch(n){}if(c.isEmptyObject(l)){clearInterval(a);a=null;}}};function h(){var o,d,n={height:j.innerHeight,width:j.innerWidth};if(!n.height){o=e.compatMode;if(o||!c.support.boxModel){d=o==="CSS1Compat"?i:e.body;n={height:d.clientHeight,width:d.clientWidth};}}return n;}function f(){return{top:j.pageYOffset||i.scrollTop||e.body.scrollTop,left:j.pageXOffset||i.scrollLeft||e.body.scrollLeft};}function g(){var s=c(),r,q=0;c.each(l,function(C,B){var z=B.data.selector,A=B.$element;s=s.add(z?A.find(z):A);});r=s.length;if(r){b=b||h();m=m||f();for(;q<r;q++){if(!c.contains(i,s[q])){continue;}var x=c(s[q]),y={height:x.height(),width:x.width()},d=x.offset(),t=x.data("inview"),p=0,o=0,n=0,v,u,w;if(p=x.data("offset")){o=p;n=p;}else{if(p=x.data("offset-left")){o=p;}else{if(p=x.data("offset-top")){n=p;}}}if(!m||!b){return;}if(d.top+y.height>m.top-n&&d.top<m.top+b.height+n&&d.left+y.width>m.left-o&&d.left<m.left+b.width+o){v=(m.left>d.left?"right":(m.left+b.width)<(d.left+y.width)?"left":"both");u=(m.top>d.top?"bottom":(m.top+b.height)<(d.top+y.height)?"top":"both");w=v+"-"+u;if(!t||t!==w){x.data("inview",w).trigger("inview",[true,v,u]);}}else{if(t){x.data("inview",false).trigger("inview",[false]);}}}}}c(j).bind("scroll resize",function(){b=m=null;});if(!i.addEventListener&&i.attachEvent){i.attachEvent("onfocusin",function(){m=null;});}})(jQuery);}function getVersion(){var date=new Date();return date.getFullYear()+"-"+date.getMonth()+"-"+date.getDate()+"-"+date.getHours();}function __DEBUG(){if(window.DRTVideoSidebar_debug){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(arguments[i]);}console.log("DRTVideoSidebar",objects);}}function getWidth(){var xWidth=null;if(window.screen!==null){xWidth=window.screen.availWidth;}if(window.innerWidth!==null){xWidth=window.innerWidth;}if(document.body!==null){xWidth=document.body.clientWidth;}return xWidth;}function getHeight(){return Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);}function isPhone(){if(getWidth()<768){return true;}return false;}function buildHtmlSidebar(videos,maxVideos){var html="";var count=0;for(var i=0;i<videos.length;i++){var video=videos[i];if(video){var videoId=video.video.replaceAll("https://www.youtube.com/watch?v=","");if(count>=maxVideos){break;}var label=count+1;html+='<li class="result-news">';if(count==0){html+='<div class="duroty-video-sidebar" data-video="'+videoId+'">';html+='<div id="player-sidebar-'+videoId+'"></div>';html+='<div id="player-sidebar-'+videoId+'-ad"></div>';html+="</div>";}html+='<a class="page-link" href="'+video.url+'" data-gtm-element="container-child-link" gtm-element-label="'+label+'">'+video.headline+"</a>";html+="</li>";count++;}}return html;}function buildYoutubeSidebarMobile($parent,videos){var $section=$parent.find(".article-sidebar").first();if($parent.find(".duroty-videos").length==0){var html="";html+='<div class="listing-article-sidebar duroty-videos" style="display: block; margin-top: -10px;">';html+='<div class="listing contentNews-listing latest-listing view-list">';html+='<div class="box-title board-title-container">';html+='<div class="board-title" data-container-number="2">';html+='<div class="board-title-left">LOS MEJORES VÍDEOS</div>';html+="</div>";html+="</div>";html+='<ul class="section-list">';html+=buildHtmlSidebar(videos,window.DRTVideoSidebar_maxvideos_mobile);html+="</ul>";html+="</div>";html+="</div>";$section.prepend(html);setInview($parent);}}function buildYoutubeSidebarDesktop($parent,videos){var $list=$parent.find(".listing-article-sidebar").first();var html="";var $section=null;if($list.length==0){if($parent.find(".sidebar-dynamic").find(".duroty-videos").length==0){$section=$parent.find(".sidebar-dynamic").find(".sticky-box").first();}html+='<div class="listing-article-sidebar sticky-box" style="display: block;">';html+='<div class="listing contentNews-listing latest-listing view-list">';html+='<div class="box-title board-title-container">';html+='<div class="board-title" data-container-number="2">';html+='<div class="board-title-left">Los mejores vídeos</div>';html+="</div>";html+="</div>";html+='<ul class="section-list">';html+=buildHtmlSidebar(videos,window.DRTVideoSidebar_maxvideos);html+="</ul>";html+="</div>";html+="</div>";if($section){$section.after(html);}}else{$list.find(".board-title-left").text("Los mejores vídeos");if($parent.find(".sidebar-dynamic").find(".duroty-videos").length==0){$section=$list.find(".section-list");$section.find("li").remove();$list.addClass("duroty-videos");$list.addClass("sticky-box");}html+=buildHtmlSidebar(videos,window.DRTVideoSidebar_maxvideos);if($section){$section.html(html);}}setInview($parent);}function buildYoutubeSidebar($parent,videos){if(isPhone()){if(window.DRTVideoSidebar_enableMobile){buildYoutubeSidebarMobile($parent,videos);}}else{if(window.DRTVideoSidebar_enableDesktop){buildYoutubeSidebarDesktop($parent,videos);}}}function setInview($parent){setTimeout(function(){$parent.find(".duroty-video-sidebar").each(function(){var $el=$(this);$el.bind("inview",function(e,visible){if(visible){var $this=$(this);try{var $this=$(this);var video=$this.attr("data-video");godo.ads.push(function(x){x.requestVideoAdUrl({slotName:"pre-roll",callback:function callback(url){createVideo("player-sidebar-"+video,video,url);},customParams:{player:"youtube"}});});}catch(e){console.log(e);}}});});},10);}function makeAdsRequest(adsRequest){adsRequest.adTagUrl=__adTagUrl;}var __adTagUrl=false;function createVideo(id,video,url){__adTagUrl=url;player=new YT.Player(id,{videoId:video,playerVars:{"autoplay":1,"loop":1,"mute":1},events:{"onReady":function(event){imaManager=new YT.ImaManager(player,id,id+"-ad",makeAdsRequest);},"onStateChange":function(event){if(event.data==YT.PlayerState.ENDED){}else{}}},embedConfig:{enableIma:true,disabledRelatedVideos:true,adsConfig:{disableAds:true}}});}function startSidebar(){$.ajax({url:"https://stories.lavanguardia.com/especial/feeds/LaVanguardia/videos/los-mejores-videos.jsonp",dataType:"jsonp",data:{"version":getVersion()},jsonpCallback:"callbackLosmejoresvideos",cache:true}).done(function(json){try{var videos=json.data;if(videos&&videos.length>0){var css="<style>";css+=".duroty-videos .view-list {position: sticky; top: 45px;}";css+=".duroty-video-sidebar {";css+="position: relative;";css+="width: 100%;";css+="height: 0;";css+="padding-bottom: 56.25%;";css+="margin-bottom: 8px;";css+="}";css+=".duroty-video-sidebar iframe {";css+="position: absolute;";css+="top: 0;";css+="left: 0;";css+="width: 100%;";css+="height: 100%;";css+="}";css+="</style>";$("body").append(css);buildYoutubeSidebar($("body"),videos);}}catch(e){}});}function init(){if(typeof jQuery!="undefined"){if(!initiated){initiated=true;load();$(document).ready(function(){startSidebar();});}}else{window.setTimeout(init,50);}}return{init:init};}());if(window.DRTVideoSidebar_enable){DRTVideoSidebar.init();}
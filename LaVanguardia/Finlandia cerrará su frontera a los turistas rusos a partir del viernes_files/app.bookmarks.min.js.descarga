var XalokBookmark_debug=window.DRTOptimize_config["debug"];var XalokBookmark_usernames=false;var XalokBookmark_mode="subscriptor";var XalokBookmark=XalokBookmark||{};XalokBookmark=(function(){var initiated=false;var initSearch=false;var inifito=true;var DOMAIN="https://www.lavanguardia.com";var BASE_PATH="https://stories.lavanguardia.com";var SELECTOR="article.article-module";var BOOKMARK_ON='<span class="bookmark-inner"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bookmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="svg-inline--fa fa-bookmark fa-w-12"><path fill="currentColor" d="M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z" class=""></path></svg></span>';var BOOKMARK_OFF='<span class="bookmark-inner"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="bookmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="svg-inline--fa fa-bookmark fa-w-12"><path fill="currentColor" d="M336 0H48C21.49 0 0 21.49 0 48v464l192-112 192 112V48c0-26.51-21.49-48-48-48zm0 428.43l-144-84-144 84V54a6 6 0 0 1 6-6h276c3.314 0 6 2.683 6 5.996V428.43z" class=""></path></svg></span>';var TRASH='<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-trash-alt fa-w-14"><path fill="currentColor" d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z" class=""></path></svg>';var MD5=function(d){var r=M(V(Y(X(d),8*d.length)));return r.toLowerCase();};function M(d){for(var _,m="0123456789ABCDEF",f="",r=0;r<d.length;r++){_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);}return f;}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++){_[m]=0;}for(m=0;m<8*d.length;m+=8){_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;}return _;}function V(d){for(var _="",m=0;m<32*d.length;m+=8){_+=String.fromCharCode(d[m>>5]>>>m%32&255);}return _;}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e);}return Array(m,f,r,i);}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m);}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n);}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n);}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n);}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n);}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m;}function bit_rol(d,_){return d<<_|d>>>32-_;}function trackEvent(c,a,l){var data={"event":c,"eventAction":a,"eventLabel":l,"eventValue":null};dataLayer.push(data);if(XalokBookmark_debug){console.log("XalokBookmark GA",data);}}function __getParam(name){try{var urlParams=new URLSearchParams(window.location.search);return urlParams.get(name);}catch(e){return false;}}function __getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length);}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length);}}return null;}function __createCookie(name,value,days){var expires="";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString();}document.cookie=name+"="+value+expires+";domain=.lavanguardia.com;path=/";}function __deleteCookie(name){document.cookie=name+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;";}function __parseGuid(guid){var tmp=guid.split(";");for(var i=0;i<tmp.length;i++){var tmp2=tmp[i].split("=");if(tmp2[0]=="_id_guid"){return tmp2[1];}}return false;}function __getGUID(){var subscriptor=__getCookie("_pac");if(XalokBookmark_mode=="subscriptor"&&subscriptor!=1){return false;}var guid=__parseGuid(decodeURIComponent(__getCookie("_id_guid")));if(guid){return guid;}return false;}function getUrl(url){try{return url.split("?")[0];}catch(e){}return url;}function getUrlId(url){try{return MD5(url.split("?")[0]);}catch(e){}return false;}function __loadJS(){!function(o){"object"==typeof module&&"object"==typeof module.exports?o(require("jquery"),window,document):o(jQuery,window,document);}(function(o,t,i,e){var s=[],l=function(){return s.length?s[s.length-1]:null;},n=function(){var o,t=!1;for(o=s.length-1;o>=0;o--){s[o].$blocker&&(s[o].$blocker.toggleClass("current",!t).toggleClass("behind",t),t=!0);}};o.modal=function(t,i){var e,n;if(this.$body=o("body"),this.options=o.extend({},o.modal.defaults,i),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),this.$blocker=null,this.options.closeExisting){for(;o.modal.isActive();){o.modal.close();}}if(s.push(this),t.is("a")){if(n=t.attr("href"),this.anchor=t,/^#/.test(n)){if(this.$elm=o(n),1!==this.$elm.length){return null;}this.$body.append(this.$elm),this.open();}else{this.$elm=o("<div>"),this.$body.append(this.$elm),e=function(o,t){t.elm.remove();},this.showSpinner(),t.trigger(o.modal.AJAX_SEND),o.get(n).done(function(i){if(o.modal.isActive()){t.trigger(o.modal.AJAX_SUCCESS);var s=l();s.$elm.empty().append(i).on(o.modal.CLOSE,e),s.hideSpinner(),s.open(),t.trigger(o.modal.AJAX_COMPLETE);}}).fail(function(){t.trigger(o.modal.AJAX_FAIL);var i=l();i.hideSpinner(),s.pop(),t.trigger(o.modal.AJAX_COMPLETE);});}}else{this.$elm=t,this.anchor=t,this.$body.append(this.$elm),this.open();}},o.modal.prototype={constructor:o.modal,open:function(){var t=this;this.block(),this.anchor.blur(),this.options.doFade?setTimeout(function(){t.show();},this.options.fadeDuration*this.options.fadeDelay):this.show(),o(i).off("keydown.modal").on("keydown.modal",function(o){var t=l();27===o.which&&t.options.escapeClose&&t.close();}),this.options.clickClose&&this.$blocker.click(function(t){t.target===this&&o.modal.close();});},close:function(){s.pop(),this.unblock(),this.hide(),o.modal.isActive()||o(i).off("keydown.modal");},block:function(){this.$elm.trigger(o.modal.BEFORE_BLOCK,[this._ctx()]),this.$body.css("overflow","hidden"),this.$blocker=o('<div class="'+this.options.blockerClass+' blocker current"></div>').appendTo(this.$body),n(),this.options.doFade&&this.$blocker.css("opacity",0).animate({opacity:1},this.options.fadeDuration),this.$elm.trigger(o.modal.BLOCK,[this._ctx()]);},unblock:function(t){!t&&this.options.doFade?this.$blocker.fadeOut(this.options.fadeDuration,this.unblock.bind(this,!0)):(this.$blocker.children().appendTo(this.$body),this.$blocker.remove(),this.$blocker=null,n(),o.modal.isActive()||this.$body.css("overflow",""));},show:function(){this.$elm.trigger(o.modal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=o('<a href="#close-modal" rel="modal:close" class="close-modal '+this.options.closeClass+'">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass).appendTo(this.$blocker),this.options.doFade?this.$elm.css({opacity:0,display:"inline-block"}).animate({opacity:1},this.options.fadeDuration):this.$elm.css("display","inline-block"),this.$elm.trigger(o.modal.OPEN,[this._ctx()]);},hide:function(){this.$elm.trigger(o.modal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove();var t=this;this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration,function(){t.$elm.trigger(o.modal.AFTER_CLOSE,[t._ctx()]);}):this.$elm.hide(0,function(){t.$elm.trigger(o.modal.AFTER_CLOSE,[t._ctx()]);}),this.$elm.trigger(o.modal.CLOSE,[this._ctx()]);},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||o('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show());},hideSpinner:function(){this.spinner&&this.spinner.remove();},_ctx:function(){return{elm:this.$elm,$elm:this.$elm,$blocker:this.$blocker,options:this.options};}},o.modal.close=function(t){if(o.modal.isActive()){t&&t.preventDefault();var i=l();return i.close(),i.$elm;}},o.modal.isActive=function(){return s.length>0;},o.modal.getCurrent=l,o.modal.defaults={closeExisting:!0,escapeClose:!0,clickClose:!0,closeText:"Close",closeClass:"",modalClass:"modal",blockerClass:"jquery-modal",spinnerHtml:'<div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div>',showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1},o.modal.BEFORE_BLOCK="modal:before-block",o.modal.BLOCK="modal:block",o.modal.BEFORE_OPEN="modal:before-open",o.modal.OPEN="modal:open",o.modal.BEFORE_CLOSE="modal:before-close",o.modal.CLOSE="modal:close",o.modal.AFTER_CLOSE="modal:after-close",o.modal.AJAX_SEND="modal:ajax:send",o.modal.AJAX_SUCCESS="modal:ajax:success",o.modal.AJAX_FAIL="modal:ajax:fail",o.modal.AJAX_COMPLETE="modal:ajax:complete",o.fn.modal=function(t){return 1===this.length&&new o.modal(this,t),this;},o(i).on("click.modal",'a[rel~="modal:close"]',o.modal.close),o(i).on("click.modal",'a[rel~="modal:open"]',function(t){t.preventDefault(),o(this).modal();});});}function __modalLogin(){if($("#bookmark-modal-login").length==0){var html="";if(XalokBookmark_mode=="subscriptor"){html+='<div id="bookmark-modal-login" class="modal-bookmarks">';html+="<p>Debes ser suscriptor para poder guardar tus Favoritos</p>";html+='<p>Suscríbete <a href="https://www.lavanguardia.com/suscripciones/suscribete.html?utm_source=lavanguardia&utm_medium=boton-favoritos&utm_campaign=favoritos&utm_content=favoritos">AQUÍ</a></p>';html+="</div>";}else{html+='<div id="bookmark-modal-login" class="modal-bookmarks">';html+="<p>Debes estar registrado para poder guardar tus Favoritos</p>";html+='<p>Regístrate <a href="https://www.lavanguardia.com/perfil/ev/login">AQUÍ</a></p>';html+="</div>";}$("body").append(html);}$("#bookmark-modal-login").modal({escapeClose:true,clickClose:true,showClose:true,modalClass:"modal-bookmarks"});}function __modalBookmarks(){if($("#bookmark-modal").length==0){var html="";html+='<div id="bookmark-modal" class="modal-bookmarks bookmark-modal">';html+='<form id="bookmarks-form" action="" method="get" style="margin:0; display: block;"><input id="bookmarks-query" type="text" name="q" style="width:100%;padding:10px;" placeholder="Busca tus favoritos"></form>';html+='<div id="bookmark-results" class="bookmark-results"><div id="bookmarks-articles" class="bookmarks-articles" data-page="1"></div></div>';html+="</div>";$("body").append(html);$("#bookmark-modal").on($.modal.OPEN,function(event,modal){if(!initSearch){initSearch=true;inifito=true;__search(false,1);}});$("#bookmarks-form").submit(function(e){e.preventDefault();inifito=true;__search($(this).find("#bookmarks-query").val(),1);});$("#bookmarks-articles").on("scroll",function(){var $this=$(this);var offset=100;if(offset+$this.scrollTop()+$this.innerHeight()>=$this[0].scrollHeight){if(inifito){inifito=false;__search($("bookmarks-form").find("#bookmarks-query").val(),$this.attr("data-page"));}}});}$("#bookmark-modal").modal({escapeClose:true,clickClose:true,showClose:true,modalClass:"modal-bookmarks"});}function buildItems(results){var html="<div>";for(var i=0;i<results.length;i++){var article=results[i];html+='<a id="bookmark-'+article.id+'" href="'+article.url+'" class="bookmark-item">';if(article.image&&article.image!="https://www.lavanguardia.com/images/default.jpg"){html+='<div class="bookmark-image"><img src="'+article.image+'" /></div>';}html+='<div class="bookmark-detail">';html+='<p class="bookmark-section">'+article.sections+"</p>";html+="<h1>"+article.title+"</h1>";html+='<p class="bookmark-author">'+article.authors+"</p>";html+='<span class="trash" data-id="'+article.id+'">'+TRASH+"</span>";html+="</div>";html+="</a>";}html+="</div>";var $html=$(html);$html.find(".trash").click(function(e){e.preventDefault();__createCookie("bookmarks-refresh","yes",1);var id=$(this).attr("data-id");__delete(id);$("#bookmark-"+id).remove();return false;});$html.find(".bookmark-item").click(function(e){trackEvent("layout","bookmarks","read-article");});return $html;}function __buildResults(results,page){var $items=$("#bookmarks-articles");$items.attr("data-page",page);if(page<3){$items.html(buildItems(results));}else{$items.append(buildItems(results));}}function __set(url,remove){if(remove){trackEvent("layout","bookmarks","delete-article");}else{trackEvent("layout","bookmarks","add-article");}var guid=__getGUID();var urlId=getUrlId(url);if(guid&&urlId){$.ajax({url:BASE_PATH+"/bookmarks/api/set.json",dataType:"jsonp",jsonpCallback:"callbackSetBookmark",cache:false,data:{id:guid,url:url,urlId:urlId}}).done(function(json){}).fail(function(jqxhr,textStatus,error){});}else{__modalLogin();}}function __delete(id){trackEvent("layout","bookmarks","delete-article");var guid=__getGUID();if(guid&&id){$.ajax({url:BASE_PATH+"/bookmarks/api/delete.json",dataType:"jsonp",jsonpCallback:"callbackSetBookmark",cache:false,data:{id:id}}).done(function(json){}).fail(function(jqxhr,textStatus,error){});}else{__modalLogin();}}function __search(query,page){var guid=__getGUID();if(guid){var data={id:guid,page:page};if(query){data["q"]=query;}$.ajax({url:BASE_PATH+"/bookmarks/api/search.json",dataType:"jsonp",jsonpCallback:"callbackSearchBookmark",cache:false,data:data}).done(function(json){var results=json.model.results;__buildResults(results,json.model.nextPage);if(results.length>0){inifito=true;}}).fail(function(jqxhr,textStatus,error){});}else{__modalLogin();}}function __check(urls){var guid=__getGUID();if(guid){$.ajax({url:BASE_PATH+"/bookmarks/api/check.json",dataType:"jsonp",jsonpCallback:"callbackCheckBookmark",cache:false,data:{domain:DOMAIN,id:guid,urls:urls}}).done(function(json){var results=json.model.results;$.each(results,function(key,urlId){var $element=$(".bookmark-off[data-urlId='"+urlId+"']");if($element.length==0){var $element=$(".bookmark-off-detail[data-urlId='"+urlId+"']");}if($element.length>0){$element.html(BOOKMARK_ON);$element.addClass("bookmark-on");}});}).fail(function(jqxhr,textStatus,error){});}else{}}function __menu(){$(".header-menu").find("ul").prepend('<li itemprop="name"><a href="#" class="bookmark-menu-a" title="Tus Favoritos"><span class="bookmark-menu">'+BOOKMARK_ON+"</span></a></li>");setTimeout(function(){$(".bookmark-menu-a").click(function(e){trackEvent("layout","bookmarks","open");});},0);}function buildDetail($parent){if($parent.find(".social-share .social-left").find(".bookmark-off-detail").length==0){var href=getUrl(top.location.href);var urlId=getUrlId(href);$parent.find(".social-share .social-left").append('<a href="#" class="share-icon share-generic bookmark-off-detail" data-urlId="'+urlId+'" data-href="'+href+'">'+BOOKMARK_OFF+"</a>");setTimeout(function(){$parent.find(".social-share .social-left").find(".bookmark-off-detail").click(function(e){e.preventDefault();__createCookie("bookmarks-refresh","yes",1);var $this=$(this);var guid=__getGUID();if(guid){if($this.hasClass("bookmark-on")){$this.html(BOOKMARK_OFF);$this.removeClass("bookmark-on");__set($this.attr("data-href"),true);}else{$this.html(BOOKMARK_ON);$this.addClass("bookmark-on");__set($this.attr("data-href"),false);}}return false;});},100);}}function start(){__loadJS();var urls="";var $elements=$(SELECTOR);if($elements.length>0){__menu();$elements.each(function(index,el){var $el=$(el);var href=$el.find(".title a").attr("href");if(href&&!href.startsWith("https")){href=DOMAIN+href;var urlId=getUrlId(href);if(urlId){if(urls.length>0){urls+=",";}urls+=urlId;$el.find(".article-details").append('<span class="bookmark-off" data-urlId="'+urlId+'" data-href="'+href+'">'+BOOKMARK_OFF+"</span>");}}});$(".bookmark-off").click(function(e){e.preventDefault();__createCookie("bookmarks-refresh","yes",1);var $this=$(this);var guid=__getGUID();if(guid){if($this.hasClass("bookmark-on")){$this.html(BOOKMARK_OFF);$this.removeClass("bookmark-on");__set($this.attr("data-href"),true);}else{$this.html(BOOKMARK_ON);$this.addClass("bookmark-on");__set($this.attr("data-href"),false);}}else{__modalLogin();}return false;});}else{buildDetail($("body"));document.addEventListener("infiniteScrollChangeUrl",function(event){buildDetail($(event.articleContainer));});}$(".bookmark-top,.bookmark-menu-a").click(function(e){e.preventDefault();__modalBookmarks();return false;});if(urls.length>0){}}function init(){if(typeof jQuery!="undefined"){if(!initiated){initiated=true;$(document).ready(function(){if(XalokBookmark_usernames){var username=__getCookie("_id_username");if(username&&XalokBookmark_usernames[username]==username){start($("body"));}}else{start($("body"));}});}}else{window.setTimeout(init,50);}}return{init:init};}());XalokBookmark.init();
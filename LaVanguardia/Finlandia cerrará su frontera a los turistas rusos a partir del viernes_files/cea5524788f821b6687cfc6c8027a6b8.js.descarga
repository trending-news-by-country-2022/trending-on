!function(){let e,t=window,n=!0,o={},a=function(){},r=function(){},s=function(){},i=function(){};try{e=window.top}catch(o){n=!1,e=t}e.__wmass||(e.__wmass={});let c,l="outxurl",d="outxgam",f="outxcon",u=Math.floor(100*Math.random()),p={},m={forceDmpId:{anyof:"string"},forceDmpPKey:{anyof:"string"}},g="sijai",b=(void 0!==e.orientation||navigator.userAgent.indexOf("IEMobile"),e.innerWidth||e.document.documentElement&&0!==e.document.documentElement.clientWidth&&e.document.documentElement.clientWidth||e.document.getElementsByTagName("body")[0].clientWidth,"_papns"),h=["per_gd","_pdfps"];try{e.__wmass.logger||(e.__wmass.logger=(t="",n="")=>{let a,r,s,i,c=[],l=[],d=[],f=[],u=()=>{let e=new Date,t=e.getMilliseconds().toString();return`${e.toLocaleTimeString()}:${t.padStart(4,"0")}`},p=e=>{let t={info:1,log:2,warn:3,error:4}[o.enableLog];return!0===o.enableLog||t>=e};if(a=r=s=i=function(){},e.console){let o=`${"%cWemass"}${t}`,m=["display: inline-block; color: #fff; background: #92c01f; padding: 1px 4px; border-radius: 3px;",n];e.console.info&&(a=function(){let e=p(1),t=o+"%c INFO",n=[...m,"display: inline-block; color: #111 background: #e3e3e3; padding: 1px 4px; border-radius: 3px;"],a=Array.prototype.slice.call(arguments),r=[t,...n,u(),...a];if(e){for(;c.length>0;)c.shift()();console.info.apply(console,r)}else c.push(console.info.bind(console,...r))}),e.console.log&&(r=function(){let e=p(2),t=o+"%c LOG",n=[...m,"display: inline-block; color: #111 background: #3c3c3b; padding: 1px 4px; border-radius: 3px;"],a=Array.prototype.slice.call(arguments),r=[t,...n,u(),...a];if(e){for(;l.length>0;)l.shift()();console.log.apply(console,r)}else l.push(console.log.bind(console,...r))}),e.console.warn&&(s=function(){let e=p(3),t=o+"%c WARN",n=[...m,"display: inline-block; color: #111 background: orange; padding: 1px 4px; border-radius: 3px;"],a=Array.prototype.slice.call(arguments),r=[t,...n,u(),...a];if(e){for(;d.length>0;)d.shift()();console.warn.apply(console,r)}else d.push(console.warn.bind(console,...r))}),e.console.error&&(i=function(){let e=p(4),t=o+"%c ERROR",n=[...m,"display: inline-block; color: #111 background: red; padding: 1px 4px; border-radius: 3px;"],a=Array.prototype.slice.call(arguments),r=[t,...n,u(),...a];if(e){for(;f.length>0;)f.shift()();console.error.apply(console,r)}else f.push(console.error.bind(console,...r))})}return[a,r,s,i]}),[a,r,s,i]=e.__wmass.logger("%cDMP","display: inline-block; color: #fff; background: #658; padding: 1px 4px; border-radius: 3px;")}catch(e){}let y=[];e.__wmass.getSegments=function(e){let t=w(e),{callback:n,adunit:o,extraKw:s=!1,format:c}="object"===t?e:{},u=["gamvideo","gamvideohb"].indexOf(c)>-1?"wpm":"permutive",p=!1,m=function(){let e={},t=N(),n=(t=u,n=b)=>{let o=[];try{o=JSON.parse(window.localStorage.getItem(n)||"[]").slice(0,250).map(String)}catch(e){o=[]}o.length>0&&(e[t]=o)};if(!1!==p){let t=/^\/\d+\//;t.test(p)&&(p=p.replace(t,""));let n=p.split("/"),o=1;for(let t=0;t<n.length;t++){n[t].length>0&&(e[`au${o}`]=[`${o>1?"/":""}${n[t]}`],o++)}}if(t||(-1===y.indexOf(d)&&S()&&y.push(d),-1===y.indexOf(l)&&T()&&y.push(l),-1===y.indexOf(f)&&O()&&y.push(f)),n(),"array"===w(h)&&h.length>0){let[e,t]=h;e=["gamvideo","gamvideohb"].indexOf(c)>-1&&0===e.indexOf("per")?"permutive":e,n(e,t)}if(y.length>0&&(e.wirr=y,r("segmentos de wemass declarados",JSON.stringify(e))),!1!==s)for(let t in s){let n=s[t],o=w(n);if(!e[t])switch(o){case"array":e[t]=n;break;case"number":e[t]=[n.toString()];break;case"string":n.length>0&&(n.indexOf(",")>-1?e[t]=n.split():e[t]=[n])}}return"xandr"===c?e:E(c,e)};if("object"!==t&&"undefined"!==t&&i(`argumento pasado a getsegments incorrecto. Se esperaba object se recibio ${t}`),p="string"==typeof o&&o.length>0?o:D(),"function"!=typeof n)return m();a("llamando a getSegments con callback");var g=500,_=100,v=function(){var e=m(),t=_<g?_:g;e[u]&&e.wirr||g<=0?n(e):(g-=t,setTimeout(v,t))};"number"==typeof e.timeout&&(g=e.timeout),"number"==typeof e.interval&&(_=e.interval),v()},r("funcion getSegments sobreescrita");let _=t=>{let n=`${t}=`,o=e.document.cookie.split(";");for(let e of o){for(;" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(n))return e.substring(n.length,e.length)}return null},w=(e,t)=>{var n,o=Object.prototype.toString.call(e);return t=t||{},n||void 0!==e||(n="undefined"),n||null!==e||(n="null"),!n&&e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)&&(n="buffer"),n||"object"!=typeof window||e!==window||(n="global"),n||"object"!=typeof global||e!==global||(n="global"),!n&&"number"==typeof e&&isNaN(e)&&(n="nan"),!n&&"object"==typeof e&&"[object Number]"==o&&isNaN(e)&&(n="nan"),n||"object"!=typeof e||"Event]"!=o.substr(-6)||(n="event"),n||"[object HTML"!=o.substr(0,12)||(n="html"),n||"[object Node"!=o.substr(0,12)||(n="html"),n||(n=o.match(/\[object\s*([^\]]+)\]/)[1].toLowerCase()),"object"==n&&t.pojoOnly&&e.constructor&&"Object"==(n=e.constructor.name||"unknown")&&(n="object"),n},v=(e,t,n)=>{let o=new Date,a=1e3,r={B:()=>{a*=0},M:e=>{a*=60*e},H:e=>{a*=3600*e},D:e=>{a*=86400*e},X:()=>{a*=864e5}};for(let e=0;e<t.length;e++)t[e]in r&&r[t[e]](parseInt(t.replace(t[e],""))||1);a+=o.getTime(),o.setTime(a),document.cookie=`${n}=${e}; path=/; domain=${location.hostname}; expires=${o.toUTCString()}; samesite=none; secure`};try{e.__wmass.testMode||(e.__wmass.testMode=function(t={},n="wmsstst"){let o=e=>{let t=["raPreviewMode=0; Max-Age=0; path=/; samesite=None; domain=.richaudience.com; secure","apn_prebid_debug=0; Max-Age=0; samesite=none; secure"];for(let e of t)document.cookie=e;!1===e?v(e,"B",n):v(JSON.stringify(e),"H",n)},r=(e=>{let t={enableLog:{values:[!0,"info","log","warn","error"],cookie:!0}};for(let n in e)t[n]||(t[n]=e[n]);return t})(t);return(t={})=>{if(!1===t)return o(!1),{};if("object"===w(t)){let s=(()=>{let e=_(n);if("string"===w(e))try{return JSON.parse(e)}catch(t){console.log(t,`error > valor de wmsstst = ${e}`)}return{}})(),i=(()=>{let t="wmsstst",n=e.location.search.replace("?","");if(-1===n.indexOf(t))return{};let o=n.split("&"),r={};for(let e of o)if(-1!==e.indexOf(t))if(e===t)r[enableTestCreatives]=!0;else{let[t,n]=e.replace("wmsstst.","").split("=");0===t.indexOf("key.")?(t=t.replace("key.",""),r.keywords||(r.keywords={}),r.keywords[t]||(r.keywords[t]=[]),-1===r.keywords[t].indexOf(n)&&r.keywords[t].push(n)):("true"===n&&(n=!0),"string"===w(n)&&r[t]?("string"===w(r[t])&&(r[t]=[r[t]]),r[t].push(n)):r[t]=n)}return a("parametros wemass detectados",r),r})(),c=((...e)=>{let t={};for(let n of e)if("object"===w(n))for(let e in n)t[e]||(t[e]=n[e]);return t})(t,s,i),l={},d={};for(let e in c)if(r[e]){let t=!1,n=c[e],o=r[e],{values:a,cookie:s=!1,anyof:i}=o,f=w(a),u=w(i),p=w(n);switch("string"===u&&p===i&&(t=!0),f){case"array":a.indexOf(n)>-1&&(t=!0);break;case"boolean":t=!0===n;case"function":t=a(n)}!0===t&&(d[e]=n,!0===s&&(l[e]=n))}return Object.keys(l).length>0&&o(l),d}}}),o=new e.__wmass.testMode(m,"cea5524788f821b6687cfc6c8027a6b8")()}catch(e){}let{pathname:k,hostname:x,search:j}=e.location;x=x.toLowerCase(),k=k.toLowerCase(),r("Loading Wemass DMP Tag GODO_NS~DMP");let C,$,O=()=>!!e.document.querySelector("span.intext-md,span.intext-xs"),S=()=>{if(e.googletag&&e.googletag.pubads){let t,n=["t"],o=["irr"];try{t=e.googletag.pubads().getSlots()}catch(e){t=[]}for(let e of t)for(let t of n){let n=e.getTargeting(t).pop();if(o.indexOf(n)>-1)return!0}}return!1},T=()=>!1,N=()=>!!e.document.getElementById("meter-paywall")&&(s("Es paywall por capa, no se pasan segmentos de outstream"),!0),E=(e,t)=>{let n=t,o=Object.keys(n);if("gamvideo"===e){let e=o.map((e=>`${e}=${n[e].join()}`));return e=e.join("&"),encodeURIComponent(e)}if("gamvideohb"===e){let e={};return o.map((t=>{e[t]=n[t].join()})),e}if("smart"===e){return o.map((e=>`${e}=${n[e].join()}`)).join(";")}if("richaudience"===e){return o.map((e=>{let t=[];return n[e].map((n=>{t.push(`${e}=${n}`)})),t.join(";")})).join(";")}return n},L=e=>"addon"===e?function(t,n={},...o){"object"!==w(n)&&(n={}),n.page||(n.page={});let s=JSON.stringify(n),i=n.page.type,l={page:"obj",content:"obj",article:"obj",user:"obj",type:!0,id:!0,title:!0,description:!0,subsection:!0,section:!0,gender:!0,categories:"arr",authors:"arr",topics:"arr",premium:"boo",wordCount:"int",paragraphCount:"int",age:"int",modifiedAt:!0,publishedAt:!0},d=/[0-9]{4}([0-9\-]{3}){2}[T0-9]{3}([0-9:]{3}){2}\.[0-9]{3}Z/,f=e=>"string"===w(e)&&e.length>0,u=e=>{let t=[];return(e=>"array"===w(e)&&e.length>0)(e)?e.map((e=>{f(e)&&-1===t.indexOf(e)&&t.push(e)})):f(e)&&t.push(e),t},p=(e,t)=>{let n=!1,o=e[t],a=w(o);if(l[t])switch(l[t]){case"obj":if("object"===a){for(let n in e[t])p(e[t],n);0===Object.keys(e[t]).length&&(n=!0)}else n=!0;break;case"int":isNaN(parseInt(o))?n=!0:e[t]=parseInt(e[t]);break;case"boo":"boolean"!==a&&("false"===o||"true"===o?e[t]:n=!0);break;case"arr":o=u(o),0===o.length&&(n=!0);break;case"dat":(e=>f(e)&&d.test(e))(o)||(n=!0);break;default:f(o)||(n=!0)}!0===n&&delete e[t]};for(let e in n)p(n,e);["story","live","story-video","opinion","author","la-contra","story-reportage"].indexOf(i)>-1&&!n.page.classifications_watson&&(n.page.classifications_watson={categories:"$alchemy_taxonomy",keywords:"$alchemy_keywords",sentiment:"$alchemy_document_sentiment"}),r(`\nraw addon -> ${s}\n\nprs addon -> ${JSON.stringify(n)}`),y.length>0&&(y=[]),a(`Llamando a __wmass.dmp.${e} con argumentos`,[t,n,...o]),c[e].apply(null,[t,n,...o])}:"identify"===e?function(t=[],...n){let o=w(t);("array"===o||"string"===o)&&t.length>0&&(a(`Llamando a __wmass.dmp.${e} con argumentos`,[t,...n]),c[e].apply(null,[t,...n]))}:function(){a(`Llamando a __wmass.dmp.${e} con argumentos`,arguments),c[e].apply(null,arguments)},M=(e,n={})=>{let o="string"===w(e);if(o&&(e=n.useNs?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e)),null!=typeof n)for(let o in n)if("string"===w(o)){let a=n[o],r=w(a);switch(o){case"T":e.appendChild(document.createTextNode(a));break;case"com":e.appendChild(document.createComment(a));break;case"Ct":e.style.cssText=a;break;case"Cn":if("string"===r||"array"===r){let t,n=[];if("string"===r?t=[a]:"array"===r&&(t=a),"array"===w(t))for(let e of t)"string"===w(e)&&("."===e.charAt(0)&&(e=e.substr(1)),n.push(e));n.length>0&&e.classList.add(...n)}break;case"H":e.innerHTML=a;break;case"St":t.attachEvent&&!t.opera?e.styleSheet.cssText=a:M(e,{T:a});break;default:"useNs"!==o&&(n.useNs?e.setAttributeNS(null,o,a):e.setAttribute(o,a))}}if(o)return e},I=(n,o,i,l,d)=>{if(!e.__wmass.dmp){if((x.indexOf("lavanguardia.com")>-1||x.indexOf("lavanguardia.biz")>-1||x.indexOf("mundodeportivo.com")>-1||x.indexOf("mundodeportivo.biz")>-1||x.indexOf("zonared.mundodeportivo.com")>-1||x.indexOf("mister.mundodeportivo.com")>-1||x.indexOf("rac1.cat")>-1||x.indexOf("rac1.biz")>-1)&&e.__wmass.bff.push(A),"string"===w(i)&&i.length>0&&"string"===w(l)&&l.length>0){r(`cargando dmp projectId: ${i}, key: ${l}`),"object"!==w(p)&&(p={}),e.__wmass.dmp=e.__wmass.dmp||{};let n=["addon","identify","track","trigger","query","segment","segments","ready","on","once","user","consent"],a=/.*\.html$/.test(k),f=!0;if(!e[o]){e[o]={},c=e[o],c.q=[],c.config=d||{},c.config.projectId=i,c.config.apiKey=l,c.config.environment=c.config.environment||"production","permutive"!==o&&(b=`${o}_papns`,c.config.stateNamespace=o,c.config.consentRequired=!0),c.config.consentRequired=!0;for(let e of n)c[e]=function(e){return function(){let t=Array.prototype.slice.call(arguments,0);c.q.push({functionName:e,arguments:t})}}(e)}window.localStorage.getItem(b)&&(f=!1,(a&&u%4>0||!a&&u%3==0)&&(f=!0)),f?(s(`iniciando permutive; isN:${a}; ab:${u}`),((e="about:blank",n="asyncScript",o=t)=>{let a=M("script",{src:e,async:"async",Cn:[n]});(o.document.body||o.document.head).appendChild(a)})(`https://cdn.permutive.com/${i}-web.js`)):s(`throttling permutive; isN:${a}; ab:${u}`);for(let t of n)!e.__wmass.dmp[t]&&c[t]&&(e.__wmass.dmp[t]=L(t))}e.__wmass.dmp.ready((function(){a("permutive initialised")}),"initialised"),e.__wmass.dmp.ready((function(){a("permutive realtime")}),"realtime")}},D=()=>{try{let{godo:t={}}=e;if("object"===w(t)){let{ads:{target:{config:{unitname:e=!1}={}}={}}={}}=t;if("string"===w(e)&&e.length>0)return e}}catch(e){i(e)}return!1},A=()=>{let t=((t=!1)=>{try{let n=null;return!1!==t&&(e.localStorage?n=e.localStorage.getItem(t):navigator.cookieEnabled&&(n=_(t))),n}catch(e){}return null})(g),n=t=>{let{data:a,origin:r,source:i}=t;"https://wemass.io"===r&&(e.removeEventListener("message",n),o(a),s.parentNode.removeChild(s))},o=t=>{((t,n)=>{try{if(e.localStorage)e.localStorage.setItem(t,n);else{if(!navigator.cookieEnabled)return!1;v(n,"X",t)}}catch(e){}})(g,t),a(`UniqueId: ${t}`),__wmass.dmp.identify([{id:t,tag:"wmssId"}])},r="_wmss_messenger",s=M("iframe",{src:"about:blank",id:r,name:r,scrolling:"no",border:"no",src:"https://wemass.io/messenger",Ct:"width:0px;height:0px;border:0px;"});t?o(t):(e.addEventListener("message",n),document.body.appendChild(s))},P=()=>{if(r("permisos suficientes obtenidos o no habia CMP. Iniciando"),I(e.document,"28986622-e6be-473d-9a8f-e603a25f3c66","28986622-e6be-473d-9a8f-e603a25f3c66","390f11db-6eea-42eb-9ef9-4d27b1bb2bab",p),"array"===w(e.__wmass.bff)&&e.__wmass.bff.length>0){a("Ejecutando funciones en el buffer");for(let t of e.__wmass.bff)"function"===w(t)&&t()}"object"!==w(e.__wmass.bff)&&(e.__wmass.bff={push:function(e){"function"===w(e)&&e()}})},q=(e={},t={},n=!1)=>{let o=!0,a=w(n);for(let r in e)t.hasOwnProperty(r)&&!0===t[r]?e[r]=t[r]:o=!1,!1===o&&"object"===a&&!0===n[r]&&(e[r]=n[r],o=!0);return!1===o&&i("Consentimiento insuficiente. Obtenido:",e),o},W={getVendorConsents:e=>{try{let t,n=!1,{purposeConsents:o}=e;t=!n||q({},o),!0===t&&P()}catch(e){i(e)}}},R={addEventListener:(t,n)=>{if(n){let n,o=!1,{eventStatus:a,listenerId:s,purpose:{consents:i={},legitimateInterests:c={}}={}}=t;r(`Evento DMP purposes: ejecutado. Status: ${a}`),"tcloaded"!==a&&"useractioncomplete"!==a||(n=!o||q({},i),n&&(P(),e.__tcfapi("removeEventListener",2,(e=>{e&&r("Evento DMP purposes eliminado")}),s)))}}},B={milis:!1,callback:P};e.__wmass.bff||(e.__wmass.bff=[]),(({cmpCallbackTcf1:t={},cmpCallbackTcf2:n={},cmpTimeout:o={}})=>{let{milis:a=!1,callback:s}=o,c=w(s);if(e.__cmp||e.__tcfapi){if(e.__wmass.consentData||(e.__wmass.consentData={}),$=e.__wmass.consentData,e.__tcfapi)if(r("TCF v2 CMP detectado"),C=2,"object"===w(n)){if(!$.getTCData){let t=(t,n)=>{n&&(r(`TCF v2 generic eventListener ejecutado. Estatus: ${t.eventStatus}`),("tcloaded"===t.eventStatus||"useractioncomplete"===t.eventStatus)&&"string"===w(t.tcString)&&t.tcString.length>0&&(r(`TCF v2 generic eventListener tcdataString disponible: ${t.tcString}`),$.getTCData=t,e.__tcfapi("removeEventListener",2,(e=>{e&&r("TCF v2 generic eventListener event removed")}),t.listenerId)))};e.__tcfapi("addEventListener",2,t)}for(let t in n){let o=n[t],a=w(o);"function"===a?e.__tcfapi(t,2,o):i(`tcfversion 2 callback para ${t} es de tipo  ${a} se esperaba una funcion`)}}else i("Wemass CMP module required, tcfversion 2 detected but no cmpCallbackTcf2 set");else if(e.__cmp)if(r("TCF v1 CMP detectado"),C=1,"object"===w(t)){$.getConsentData||e.__cmp("getConsentData",null,(e=>{$.getConsentData=e})),$.getVendorConsents||e.__cmp("getVendorConsents",null,(e=>{$.getVendorConsents=e}));for(let n in t){let o=t[n],a=w(o);"function"===a?e.__cmp(n,null,o):i(`tcfversion 1 callback para ${n} es de tipo  ${a} se esperaba una funcion`)}}else i("Wemass CMP module required, tcfversion 1 detected but no cmpCallbackTcf1 set");0!=a&&"number"===w(a)&&(o.timer=setTimeout(s,a))}else"function"===c&&s()})({cmpCallbackTcf1:W,cmpCallbackTcf2:R,cmpTimeout:B})}();